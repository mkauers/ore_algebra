# coding: utf-8
r"""
PÃ³lya walks

(Thanks to Bruno Salvy.)

EXAMPLE::

    sage: from ore_algebra.examples import polya
    sage: dim = 10
    sage: polya.dop[dim].local_basis_monomials(0)
    [1/362880*log(z)^9,
     1/40320*log(z)^8,
     1/5040*log(z)^7,
     1/720*log(z)^6,
     1/120*log(z)^5,
     1/24*log(z)^4,
     1/6*log(z)^3,
     1/2*log(z)^2,
     log(z),
     1]
    sage: ini = [0]*(polya.dop[dim].order() - 1) + [1]
    sage: polya.dop[dim].numerical_solution(ini, [0, 1/(2*dim)], 1e-50)
    [1.0595437478882610713169759571798527548370189154412...] + [+/- ...]*I
"""

from sage.rings.all import PolynomialRing, ZZ
from ore_algebra import OreAlgebra

Pol, z = PolynomialRing(ZZ, 'z').objgen()
Dop, Dz = OreAlgebra(Pol, 'Dz').objgen()

dop = {}

dop[3] = ((144*z**6-40*z**4+z**2)*Dz**3 +(1296*z**5-240*z**3+3*z)*Dz**2
        +(2592*z**4-288*z**2+1)*Dz +864*z**3-48*z)

dop[4] = ((1024*z**7-80*z**5+z**3)*Dz**4 +(14336*z**6-800*z**4+6*z**2)*Dz**3
        +(55296*z**5-2048*z**3+7*z)*Dz**2 +(61440*z**4-1344*z**2+1)*Dz
        +12288*z**3-128*z)

dop[5] = ((-14400*z**10+4144*z**8-140*z**6+z**4)*Dz**5
        +(-360000*z**9+82880*z**7-2100*z**5+10*z**3)*Dz**4
        +(-2880000*z**8+515520*z**6-9268*z**4+25*z**2)*Dz**3
        +(-8640000*z**7+1158720*z**5-13608*z**3+15*z)*Dz**2
        +(-8640000*z**6+825600*z**4-5528*z**2+1)*Dz
        -1728000*z**5+109440*z**3-320*z)

dop[6] = ((-147456*z**11+12544*z**9-224*z**7+z**5)*Dz**6
        +(-4866048*z**10+338688*z**8-4704*z**6+15*z**4)*Dz**5
        +(-55296000*z**9+3075840*z**7-31808*z**5+65*z**3)*Dz**4
        +(-265420800*z**8+11450880*z**6-82880*z**4+90*z**2)*Dz**3
        +(-530841600*z**7+17072640*z**5-78720*z**3+31*z)*Dz**2
        +(-371589120*z**6+8432640*z**4-21120*z**2+1)*Dz
        -53084160*z**5+783360*z**3-768*z)

dop[7] = ((2822400*z**14-826624*z**12+31584*z**10-336*z**8+z**6)*Dz**7
        +(138297600*z**13-34718208*z**11+1105440*z**9-9408*z**7+21*z**5)*Dz**6
        +(2489356800*z**12-528711680*z**10+13751904*z**8-90384*z**6+140*z**4)*Dz**5
        +(20744640000*z**11-3670284800*z**9+76058880*z**7-367920*z**5+350*z**3)*Dz**4
        +(82978560000*z**10-12003174400*z**8+191870208*z**6-637488*z**4+301*z**2)*Dz**3
        +(149361408000*z**9-17261690880*z**7+203784192*z**5-417888*z**3+63*z)*Dz**2
        +(99574272000*z**8-8929320960*z**6+73200384*z**4-76960*z**2+1)*Dz
        +14224896000*z**7-952627200*z**5+4935168*z**3-1792*z)

dop[8] = ((37748736*z**15-3358720*z**13+69888*z**11-480*z**9+z**7)*Dz**8
        +(2264924160*z**14-174653440*z**12+3075072*z**10-17280*z**8+28*z**6)*Dz**7
        +(51791265792*z**13-3421896704*z**11+50110464*z**9-223776*z**7+266*z**5)*Dz**6
        +(577102675968*z**12-32232701952*z**10+384334848*z**8-1312416*z**6+1050*z**4)*Dz**5
        +(3329438515200*z**11-154681344000*z**9+1461829632*z**7-3620160*z**5+1701*z**3)*Dz**4
        +(9766352977920*z**10-370055577600*z**8+2675785728*z**6-4449600*z**4+966*z**2)*Dz**3
        +(13317754060800*z**9-401552179200*z**7+2117173248*z**5-2094976*z**3+127*z)*Dz**2
        +(6849130659840*z**8-159205294080*z**6+571023360*z**4-271488*z**2+1)*Dz
        +761014517760*z**7-13070499840*z**5+28606464*z**3-4096*z)

dop[9] = ((-914457600*z**18+270648576*z**16-11059840*z**14+140448*z**12-660*z**10+z**8)*Dz**9
        +(-74071065600*z**17+19486697472*z**15-696769920*z**13+7584192*z**11-29700*z**9+36*z**7)*Dz**8
        +(-2370274099200*z**16+550176012288*z**14-17038986624*z**12+156601632*z**10-498696*z**8+462*z**6)*Dz**7
        +(-38714476953600*z**15+7861661079552*z**13-208388936448*z**11+1587838560*z**9-3984288*z**7+2646*z**5)*Dz**6
        +(-348430292582400*z**14+61302652637184*z**12-1371240707328*z**10+8466726048*z**8-16052916*z**6+6951*z**4)*Dz**5
        +(-1742151462912000*z**13+262594912849920*z**11-4872727756800*z**9+23679448320*z**7-32006700*z**5+7770*z**3)*Dz**4
        +(-4645737234432000*z**12+592052526858240*z**10-8923673318400*z**8+32838948864*z**6-29054476*z**4+3025*z**2)*Dz**3
        +(-5973090729984000*z**11+633557545205760*z**9-7552421959680*z**7+19955195136*z**5-10089816*z**3+255*z)*Dz**2
        +(-2986545364992000*z**10+258683438039040*z**8-2355318466560*z**6+4133152512*z**4-935592*z**2+1)*Dz
        -331838373888000*z**9+22924354682880*z**7-152023080960*z**5+156432384*z**3-9216*z)

dop[10] = ((-15099494400*z**19+1381236736*z**17-31313920*z**15+261888*z**13-880*z**11+z**9)*Dz**10
        +(-1434451968000*z**18+117405122560*z**16-2348544000*z**14+17022720*z**12-48400*z**10+45*z**8)*Dz**9
        +(-55037657088000*z**17+4003398942720*z**15-70018781184*z**13+434058240*z**11-1022736*z**9+750*z**7)*Dz**8
        +(-1108906868736000*z**16+71140560076800*z**14-1076366573568*z**12+5616568320*z**10-10682496*z**8+5880*z**6)*Dz**7
        +(-12785043898368000*z**15+717120208896000*z**13-9269412790272*z**11+39924943872*z**9-59245296*z**7+22827*z**5)*Dz**6
        +(-86299046313984000*z**14+4189825542389760*z**12-45579233525760*z**10+158120100864*z**8-174913200*z**6+42525*z**4)*Dz**5
        +(-335607402332160000*z**13+13938763707187200*z**11-125309288448000*z**9+339239956480*z**7-262498016*z**5+34105*z**3)*Dz**4
        +(-712309588623360000*z**12+24959281161830400*z**10-181267082772480*z**8+367154708480*z**6-180852320*z**4+9330*z**2)*Dz**3
        +(-739706111262720000*z**11+21504803733504000*z**9-122558195957760*z**7+175131279360*z**5-47196224*z**3+511*z)*Dz**2
        +(-301361749032960000*z**10+7121431166976000*z**8-30648175165440*z**6+28318801920*z**4-3168192*z**2+1)*Dz
        -27396522639360000*z**9+512812803686400*z**7-1580138496000*z**5+819609600*z**3-20480*z)

dop[11] = ((442597478400*z**22-131908368384*z**20+5623611136*z**18-79036672*z**16+459888*z**14-1144*z**12+z**10)*Dz**11
        +(53554294886400*z**21-14509920522240*z**19+556737502464*z**17-6955227136*z**15+35411376*z**13-75504*z**11+55*z**9)*Dz**10
        +(2677714744320000*z**20-656377129672704*z**18+22527230492416*z**16-248099115264*z**14+1092336960*z**12-1960816*z**10+1155*z**8)*Dz**9
        +(72298298096640000*z**19-15948601363943424*z**17+486216090427392*z**15-4675761522432*z**13+17554885920*z**11-25945920*z**9+11880*z**7)*Dz**8
        +(1156772769546240000*z**18-228282388693843968*z**16+6133382879588352*z**14-50930214995712*z**12+160313819952*z**10-189669480*z**8+63987*z**6)*Dz**7
        +(11336373141553152000*z**17-1988118362182385664*z**15+46649915466190848*z**13-330087328316928*z**11+853090077840*z**9-778858080*z**7+179487*z**5)*Dz**6
        +(68018238849318912000*z**16-10521561316886839296*z**14+213351986277384192*z**12-1266070701341184*z**10+2616654537328*z**8-1754773592*z**6+246730*z**4)*Dz**5
        +(242922281604710400000*z**15-32862706737770004480*z**13+568790518996869120*z**11-2775961068103680*z**9+4433852159360*z**7-2037664200*z**5+145750*z**3)*Dz**4
        +(485844563209420800000*z**14-56919284872575713280*z**12+828566593345290240*z**10-3245244099594240*z**8+3826113154560*z**6-1086474376*z**4+28501*z**2)*Dz**3
        +(485844563209420800000*z**13-48735623597441679360*z**11+586060530417008640*z**9-1784804417187840*z**7+1456110130560*z**5-215978256*z**3+1023*z)*Dz**2
        +(194337825283768320000*z**12-16469771860055162880*z**10+160006157742735360*z**8-363194035752960*z**6+186116741760*z**4-10583792*z**2+1)*Dz
        +17667075025797120000*z**11-1244934655660523520*z**9+9497278917181440*z**7-15140675911680*z**5+4156416000*z**3-45056*z)

dop[12] = ((8697308774400*z**23-810691854336*z**21+19418054656*z**19-182161408*z**17+768768*z**15-1456*z**13+z**11)*Dz**12
        +(1200228610867200*z**22-102147173646336*z**20+2213658230784*z**18-18580463616*z**16+69189120*z**14-113568*z**12+66*z**10)*Dz**11
        +(69456707872358400*z**21-5373284333912064*z**19+104761311363072*z**17-780862111744*z**15+2538801408*z**13-3555552*z**11+1705*z**9)*Dz**10
        +(2209986159575040000*z**20-154649356853575680*z**18+2695400128512000*z**16-17687638425600*z**14+49591576320*z**12-58138080*z**10+22275*z**8)*Dz**9
        +(42621161648947200000*z**19-2683182649316474880*z**17+41505862730121216*z**15-237395270860800*z**13+565522434048*z**11-541974576*z**9+159027*z**7)*Dz**8
        +(518273325651197952000*z**18-29174607837910794240*z**16+397257243906539520*z**14-1957194082222080*z**12+3890652260352*z**10-2957587776*z**8+627396*z**6)*Dz**7
        +(4009798887932952576000*z**17-200453123470220328960*z**15+2379906470947848192*z**13-9959337130328064*z**11+16156049588224*z**9-9365532176*z**7+1323652*z**5)*Dz**6
        +(19476166027102912512000*z**16-857947146873250775040*z**14+8783550916306403328*z**12-30695893683535872*z**10+39501744242688*z**8-16556139600*z**6+1379400*z**4)*Dz**5
        +(57282841256185036800000*z**15-2203853265338735001600*z**13+19202398464717619200*z**11-54880296763392000*z**9+53996420481024*z**7-15174766880*z**5+611501*z**3)*Dz**4
        +(95471402093641728000000*z**14-3175127114384513433600*z**12+23176468770607595520*z**10-52757152019251200*z**8+37755817967616*z**6-6352979360*z**4+86526*z**2)*Dz**3
        +(80195977758659051520000*z**13-2277900312763170816000*z**11+13662903633916723200*z**9-23934399912345600*z**7+11608338825216*z**5-971803584*z**3+2047*z)*Dz**2
        +(27079161321105653760000*z**12-647578180791985766400*z**10+3115299684105584640*z**8-4009237523988480*z**6+1184120340480*z**4-34976832*z**2+1)*Dz
        +2083012409315819520000*z**11-41219712102275481600*z**9+154142349050511360*z**7-136433935319040*z**5+20544749568*z**3-98304*z)

dop[13] = ((-299195895398400*z**26+89612654505984*z**24-3933469496320*z**22+59052401408*z**20-389920960*z**18+1233232*z**16-1820*z**14+z**12)*Dz**13
        +(-50564106322329600*z**25+13979574102933504*z**23-562486137973760*z**21+7676812183040*z**19-45620752320*z**17+128256128*z**15-165620*z**13+78*z**11)*Dz**12
        +(-3640615655207731200*z**24+925986441396436992*z**22-34012880989400064*z**20+419807393497856*z**18-2229904074112*z**16+5519987616*z**14-6151964*z**12+2431*z**10)*Dz**11
        +(-146838164760045158400*z**23+34234049952040992768*z**21-1142730951395235840*z**19+12680764523691264*z**17-59734267580416*z**15+128767390752*z**13-121825704*z**11+39325*z**9)*Dz**10
        +(-3670954119001128960000*z**22+781361841051824947200*z**20-23582892952220903424*z**18+233735448131822336*z**16-967634558604480*z**14+1792829019696*z**12-1411046780*z**10+359502*z**8)*Dz**9
        +(-59469456727818289152000*z**21+11505803303599684485120*z**19-312235334967202873344*z**17+2743300949660393472*z**15-9876152399480640*z**13+15482487312864*z**11-9884546100*z**9+1899612*z**7)*Dz**8
        +(-634340871763395084288000*z**20+111018823106740939653120*z**18-2691813456121403179008*z**16+20785344799562661888*z**14-64268593742365504*z**12+83630007945744*z**10-41938882128*z**8+5715424*z**6)*Dz**7
        +(-4440386102343765590016000*z**19+699230628171517864181760*z**17-15040338172993491369984*z**15+101053524164277952512*z**13-264401729415293568*z**11+278869211690160*z**9-105308146944*z**7+9321312*z**5)*Dz**6
        +(-19981737460546945155072000*z**18+2814284606737966356234240*z**16-53267908982132794392576*z**14+307786978071362248704*z**12-669248265473990528*z**10+555057469183056*z**8-149037644028*z**6+7508501*z**4)*Dz**5
        +(-55504826279297069875200000*z**17+6945370188224298614784000*z**15-114601683268963488890880*z**13+561577544861002629120*z**11-992296313773145600*z**9+621957750234240*z**7-109443543300*z**5+2532530*z**3)*Dz**4
        +(-88807722046875311800320000*z**16+9798594710400772551475200*z**14-139420493588322722119680*z**12+569709716430037155840*z**10-795096030995084800*z**8+356823156137472*z**6-36375257124*z**4+261625*z**2)*Dz**3
        +(-72660863492897982382080000*z**15+7008495392640892089139200*z**13-84893092055974874972160*z**11+283313757936802037760*z**9-300871891962209280*z**7+89504795299968*z**5-4314918024*z**3+4095*z)*Dz**2
        +(-24220287830965994127360000*z**14+2022170348083590306201600*z**12-20533245623411669729280*z**10+54511552671472189440*z**8-41870773810191360*z**6+7341089337216*z**4-114578296*z**2+1)*Dz
        -1863099063920461086720000*z**13+133104589502874019430400*z**11-1111853120220687237120*z**9+2268821048084398080*z**7-1171987517276160*z**5+99477061632*z**3-212992*z)

dop[14] = ((-6818690079129600*z**27+644279722573824*z**25-16034446704640*z**23+162232598528*z**21-784875520*z**19+1910272*z**17-2240*z**15+z**13)*Dz**14
        +(-1288732424955494400*z**26+112748951450419200*z**24-2581545919447040*z**22+23848191983616*z**20-104388444160*z**18+227322368*z**16-235200*z**14+91*z**12)*Dz**13
        +(-104864634726934118400*z**25+8468174451807092736*z**23-177694826576216064*z**21+1491548064907264*z**19-5869828636672*z**17+11339447808*z**15-10226944*z**13+3367*z**11)*Dz**12
        +(-4839906218166190080000*z**24+359521598741170618368*z**22-6884783356404301824*z**20+52226411000365056*z**18-183465290072064*z**16+311304514560*z**14-241218432*z**12+66066*z**10)*Dz**11
        +(-140550876575546159923200*z**23+9568202789400524881920*z**21-166434974166272704512*z**19+1134076024477319168*z**17-3527064355569664*z**15+5195858004480*z**13-3399116864*z**11+752752*z**9)*Dz**10
        +(-2693891801031301398528000*z**22+167383567058349871595520*z**20-2630979992886171402240*z**18+15992827596422512640*z**16-43619370091315200*z**14+55022749816320*z**12-29746059200*z**10+5135130*z**8)*Dz**9
        +(-34786341952447674580992000*z**21+1963931621109634223308800*z**19-27732889142176870563840*z**17+149212109721702236160*z**15-352957228902252544*z**13+374967413164032*z**11-163088996928*z**9+20912320*z**7)*Dz**8
        +(-303589893403179705434112000*z**20+15496447154708600145838080*z**18-195307447265545892659200*z**16+921728519703169597440*z**14-1866313683401310208*z**12+1636230571143168*z**10-553263879168*z**8+49329280*z**6)*Dz**7
        +(-1770941044851881615032320000*z**19+81278611206237680031498240*z**17-907505559009074148802560*z**15+3717396083903504056320*z**13-6342255966786682880*z**11+4473906397255680*z**9-1124169149376*z**7+63436373*z**5)*Dz**6
        +(-6729575970437150137122816000*z**18+275994873287420911445606400*z**16-2706812005013550079672320*z**14+9505333559503167160320*z**12-13404376929806843904*z**10+7365588421847040*z**8-1293202991808*z**6+40075035*z**4)*Dz**5
        +(-15938469403666934535290880000*z**17+580059905582160183243571200*z**15-4947984713226436529356800*z**13+14676350365143819878400*z**11-16702111788171264000*z**9+6850625308262400*z**7-769650609024*z**5+10391745*z**3)*Dz**4
        +(-21895271099986899967672320000*z**16+701532484423174550716416000*z**14-5144947621003434708172800*z**12+12659561237398840934400*z**10-11276222067328942080*z**8+3256867636592640*z**6-204835547520*z**4+788970*z**2)*Dz**3
        +(-15455485482343694094827520000*z**15+432019112162837704527052800*z**13-2686880277848803560652800*z**11+5362992497346320793600*z**9-3591241862228213760*z**7+671734301736960*z**5-18955395328*z**3+8191*z)*Dz**2
        +(-4458313119906834835046400000*z**14+107580761553532313036390400*z**12-558063997299311247360000*z**10+878156972836886937600*z**8-418320303154790400*z**6+44563883212800*z**4-372612864*z**2+1)*Dz
        -297220874660455655669760000*z**13+6115166070702637842432000*z**11-25922246716898987212800*z**9+30973120040927232000*z**7-9690288519905280*z**5+473569689600*z**3-458752*z)

dop[15] = ((269276305858560000*z**30-80950584950784000*z**28+3629735201193984*z**26-57080630763520*z**24+409981265408*z**22-1499829760*z**20+2871232*z**18-2720*z**16+z**14)*Dz**15
        +(60587168818176000000*z**29-16999622839664640000*z**27+707798364232826880*z**25-10274513537433600*z**23+67646908792320*z**21-224974464000*z**19+387616320*z**17-326400*z**15+105*z**13)*Dz**14
        +(5937542544181248000000*z**28-1551046657578762240000*z**26+59789931630571929600*z**24-798278106947641344*z**22+4796169345443840*z**20-14416495588352*z**18+22181540160*z**16-16423904*z**14+4550*z**12)*Dz**13
        +(334481563322210304000000*z**27-81131900756901396480000*z**25+2886264219850496409600*z**23-35303727569401454592*z**21+192591205900620800*z**19-519787439069184*z**17+707833651200*z**15-454991264*z**13+106470*z**11)*Dz**12
        +(12041336279599570944000000*z**26-2704250458682470563840000*z**24+88474218684064461619200*z**22-987113006841956179968*z**20+4862067116732345856*z**18-11694546001056256*z**16+13948983786816*z**14-7666274304*z**12+1479478*z**10)*Dz**11
        +(291400337966309616844800000*z**25-60403894924097334804480000*z**23+1810516178566181073715200*z**21-18336647935059261603840*z**19+81033820655292578304*z**17-172214449187123200*z**15+177735512066112*z**13-81994323840*z**11+12662650*z**9)*Dz**10
        +(4856672299438493614080000000*z**24-926086890189285634867200000*z**22+25324208695139969934950400*z**20-231569354145921664204800*z**18+911597715337047246336*z**16-1694812596013786624*z**14+1491624282894720*z**12-564676102848*z**10+67128490*z**8)*Dz**9
        +(56198636607788283248640000000*z**23-9821600336936930947891200000*z**21+243895079188460801654784000*z**19-2001474041629081060638720*z**17+6961148053301631762432*z**15-11190413197947013632*z**13+8252818589658240*z**11-2491958589120*z**9+216627840*z**7)*Dz**8
        +(449589092862306265989120000000*z**22-71725429608240620136038400000*z**20+1609161818725523357171712000*z**18-11770087561727055499100160*z**16+35825937728946311725056*z**14-49112927471281826304*z**12+29704887544668864*z**10-6898246766112*z**8+408741333*z**6)*Dz**7
        +(2447762838917000781496320000000*z**21-354907365563571111670579200000*z**19+7152475405487676025208832000*z**17-46268511513163153122263040*z**15+121891943669163953209344*z**13-140140992502944986112*z**11+67667087104034880*z**9-11517430544256*z**7+420693273*z**5)*Dz**6
        +(8811946220101202813386752000000*z**20-1155571219953730314672537600000*z**18+20785112953613635862082355200*z**16-117852071549595952781721600*z**14+265216641208694799482880*z**12-250559836896574725120*z**10+93303962552021952*z**8-10897207743264*z**6+210766920*z**4)*Dz**5
        +(20027150500230006394060800000000*z**19-2362573936582134301458432000000*z**17+37651520030507075820847104000*z**15-185180175371863397892096000*z**13+350420651229762451537920*z**11-265169341550020423680*z**9+72752913986864640*z**7-5304232959840*z**5+42355950*z**3)*Dz**4
        +(26702867333640008525414400000000*z**18-2816819552897219199762432000000*z**16+39443088818742150876364800000*z**14-166217350344029675008819200*z**12+259441279222310968688640*z**10-152179348773380567040*z**8+28891552538695680*z**6-1138125841504*z**4+2375101*z**2)*Dz**3
        +(18486600461750775132979200000000*z**17-1732080379790685408067584000000*z**15+21106053778472440493506560000*z**13-75098351566004361206169600*z**11+94387689349096767160320*z**9-41091696296267489280*z**7+4930837635294720*z**5-82548913344*z**3+16383*z)*Dz**2
        +(5281885846214507180851200000000*z**16-436217453243899431616512000000*z**14+4573788149507776189562880000*z**12-13497729262079414265446400*z**10+13245706827488316948480*z**8-4031063063164477440*z**6+265858264373760*z**4-1204325184*z**2+1)*Dz
        +352125723080967145390080000000*z**15-25412342171473281024000000000*z**13+226231973017884794290176000*z**11-541574695562332078080000*z**9+398335457415580876800*z**7-77667722566041600*z**5+2222757642240*z**3-983040*z)

